<div class="main-content page-m">
    <div class="section-content section-content-p30">
        <div class="container-fluid">

            <form [formGroup]="productForm" (ngSubmit)="onSubmit()">
                <h3 class="text-center">Product Form</h3>
                <div class="row">
                    <div class="col-md-2"><label>SKU</label></div>
                    <div class="col-md-9">
                        <div class="input-space">
                            <input formControlName="sku" type="text">
                            <div *ngIf="sku?.invalid && (sku?.dirty || sku?.touched)" class="alert alert-danger mt-1">
                                <div *ngIf="sku?.errors?.['required']">
                                    SKU is required
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="row">
                    <div class="col-md-2"><label>Name</label></div>
                    <div class="col-md-9">
                        <div class="input-space">
                            <input formControlName="name" type="text">
                            <div *ngIf="name?.invalid && (name?.dirty || name?.touched)" class="alert alert-danger mt-1">
                                <div *ngIf="name?.errors?.['required']">
                                    Name is required
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-2"><label>Description</label></div>
                    <div class="col-md-9">
                        <div class="input-space">
                            <textarea formControlName="description"></textarea>
                            <div *ngIf="description?.invalid && (description?.dirty || description?.touched)" class="alert alert-danger mt-1">
                                <div *ngIf="description?.errors?.['required']">
                                    Description is required
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-2"><label>Unit Price</label></div>
                    <div class="col-md-9">
                        <div class="input-space">
                            <input formControlName="unitPrice" type="text">
                            <div *ngIf="unitPrice?.invalid && (unitPrice?.dirty || unitPrice?.touched)" class="alert alert-danger mt-1">
                                <div *ngIf="unitPrice?.errors?.['required']">
                                    Unit Price is required
                                </div>
                                <div *ngIf="unitPrice?.errors?.['pattern']">
                                    Please enter a valid number
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-2"><label>Units in Stock</label></div>
                    <div class="col-md-9">
                        <div class="input-space">
                            <input formControlName="unitsInStock" type="text">
                            <div *ngIf="unitsInStock?.invalid && (unitsInStock?.dirty || unitsInStock?.touched)" class="alert alert-danger mt-1">
                                <div *ngIf="unitsInStock?.errors?.['required']">
                                    Units in Stock are required
                                </div>
                                <div *ngIf="unitsInStock?.errors?.['pattern']">
                                    Please enter a valid number
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="row">
                    <div class="col-md-2"><label>Category</label></div>
                    <div class="col-md-9">
                        <div class="input-space">
                            <select formControlName="category" (change)="onCategoryChange()" [compareWith]="compareCategoryObjects">
                                <option value="" disabled>Select Category</option>
                                <option *ngFor="let category of productCategories" [ngValue]="category"> {{category.categoryName}} </option>   
                            </select>
                            <div *ngIf="category?.invalid && (category?.dirty || category?.touched)" class="alert alert-danger mt-1">
                                <div *ngIf="category?.errors?.['required']">
                                    Category is required
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="row">
                    <div class="col-md-2"><label>Product Image</label></div>
                    <div class="col-md-9">
                      <div class="input-space">
                        <label for="image-upload" class="custom-file-upload">
                          <i class="fas fa-cloud-upload-alt"></i>
                            <span *ngIf="!selectedFileName">Choose File</span>
                            <span *ngIf="selectedFileName">{{ selectedFileName }}</span>
                        </label>
                        <input formControlName="image" id="image-upload" (change)="onFileChange($event)" type="file" accept="image/*">
                        <div *ngIf="image?.invalid && (image?.dirty || image?.touched)" class="alert alert-danger mt-1">
                          <div *ngIf="image?.errors?.['required']">
                            Image is required
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>

                <div class="text-center">
                    <button type="submit" [disabled]="productForm.invalid" class="btn btn-remove btn-primary">
                        <span *ngIf="!isLoading">{{buttonText}}</span>
                        <span *ngIf="isLoading" class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
                        <span *ngIf="isLoading" class="sr-only">Loading...</span>
                    </button>
                    <div>
                        <h5 class="text-success text-center mt-1" *ngIf="successMessage">{{successMessage}}</h5>
                        <h5 class="text-danger text-center mt-1" *ngIf="errorMessage">{{errorMessage}}</h5>
                    </div>
                </div>
            </form>

        </div>
    </div>
</div>
